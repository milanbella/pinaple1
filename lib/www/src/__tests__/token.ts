import { importPrivateKey, importPublicKey, generateJWT, verifyJWT } from '../token';

const cPrivateKey =
`-----BEGIN PRIVATE KEY-----
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
SqPGYU/SU4g6o0N7djPyGRoKLtuulw==
-----END PRIVATE KEY-----
`;

const cPublicKey =
`-----BEGIN CERTIFICATE-----
MIIFozCCA4ugAwIBAgIUIfjrwitjAgKVod8KE2SPYzVFYJAwDQYJKoZIhvcNAQEL
BQAwYTELMAkGA1UEBhMCVVMxCzAJBgNVBAgMAkNBMQwwCgYDVQQHDANTYW4xEjAQ
BgNVBAMMCWxvY2FsaG9zdDEjMCEGCSqGSIb3DQEJARYUbG9jYWxob3N0QG9yYWNs
ZS5jb20wHhcNMjEwOTI1MTQxNjU3WhcNNDkwMjEwMTQxNjU3WjBhMQswCQYDVQQG
EwJVUzELMAkGA1UECAwCQ0ExDDAKBgNVBAcMA1NhbjESMBAGA1UEAwwJbG9jYWxo
b3N0MSMwIQYJKoZIhvcNAQkBFhRsb2NhbGhvc3RAb3JhY2xlLmNvbTCCAiIwDQYJ
KoZIhvcNAQEBBQADggIPADCCAgoCggIBANHx9mEdXXpZkotXbANyITsxhVufBI8q
uX3XfmH/TSVFKFAPit7IpSo9G6Ao/tOs9HZ/0bTWVUwJVbBEXc6qgKThvyQtg0A/
EFmXmsSzry3+DXY0mmgE33Y14oihLA8Ld3cf/8cDS/KoOVHR7iHBsStjKCKdAjU1
h5Ykg0tWjVDGg0oUj9GcNtrZi1gs6zyr5+Bj7PfnOslbklRHXJcH6YLZCm5DliPD
XpMEpMP1U8XWl2IuJrYzOiQJbuWhAMtcijhh4ffQNQwKLCpVtvO/YWPM1QyTzJQc
/FVyELGWQI0CbRjeRhykOePcadskE2QWfrkqohoYJGTE2+kGwBPmfeeLsJuAUjAH
3WqcWSjVffp3h5pxQLHOGKi82SHu5847vmurWWuWpb76M2iP+Vmq4W9K0UFFNJer
cl7evuG+0vzrc80aee++2DDK0yDx90SWIvnfBEK29WgtS47I3KvAaUtuivrc27TI
0ZregpxGDlLNg48y862Ar7AM6dkeZ0vKH6A8/N5RgtHAkvgQHvHfXoeLaeew8U6Q
5uIMcS2u1zrvDOv5/MEmX5QS9Wlm++aCFgZ69e9Xxgey2rPn5rHQqj+JM6NIYkby
P7yw5cprTj3hE0+LQKNUis0cy4fL6U9864R7CK3qySPdIR74W1/cbCd4tNN/U1TE
vctYzUR3qEopAgMBAAGjUzBRMB0GA1UdDgQWBBQoC657DjAy/tQHd20TJSV9pLtV
KDAfBgNVHSMEGDAWgBQoC657DjAy/tQHd20TJSV9pLtVKDAPBgNVHRMBAf8EBTAD
AQH/MA0GCSqGSIb3DQEBCwUAA4ICAQCtoCmotpnBSCNTy5Wu28/JmR5ZBuuxOMNS
DOQwUyFFy1IKFPU84P9/JzVm34AnY4io3H8fxGNW36kkTAp8vgmTuWnHkwazQOhp
5saYCna+Cy8arOmHdD+w/U7z0PQuM42rXagKgKu60uFZpZT8DyXeZRxXHmCCjJe3
3Y0abL3d3Oxq2m+sDDoCilfAMfaCYxBJwXFaXX/JdN4AWQfAG0TE+DJcbVZ+LBo9
Fc3kl8M2jCeOJeGQ1gDklEF8DZHjmKIdFvqTJdlwlhRUFBtL/fAlDhzObPK/uM8X
O2NzxUY3tjkmJg10Fv4JfUZmVjvNB2vnPn/y66WkfDby3a5TaGcxg0yBToZgemZR
7kZYkJvcRM20+8e1Go9hDWvxEcFfMkINP0F0czu/UXft+wlCq0To7a2J8HfKAcSC
lObHdl7AsY/ZkxPLeVlBvPd+YgPgfsIFU5XLJpuEY1NadIcbMMI/gW/+0UGjijVV
88+nOhT4zsVOx0AWF0UNaFsyzmqNCoSxjTCPorNkzu83PLe7cC82RDMBS72MvmBc
Vi5gurwBTq+1/K0XwlSDpzHBXsFHA6oetC32KpYwzObgkwcWnQBs37mrRgIdEADp
XzBMmyN3XviM+md2PQrsEUaj/8Y/D07akZOrw+spJbcIR8xRiWdfh/XWxgHK1SKK
gFlM/ybDcg==
-----END CERTIFICATE-----
`;

test('Generate and verify jwt token.', async () => {
  let privateKey = await importPrivateKey(cPrivateKey);
  let publicKey = await importPublicKey(cPublicKey);

  let jwt = await generateJWT(privateKey, '3600s');
  const {payload, protectedHeader} = await verifyJWT(jwt, publicKey);

  expect(payload).toHaveProperty('iat');
  expect(payload).toHaveProperty('exp');
  expect(payload).toHaveProperty('urn:example:claim', true);
  expect(payload).toHaveProperty('iss', 'pinaple1');
  expect(payload).toHaveProperty('aud', 'api');

  expect(protectedHeader).toHaveProperty('alg', 'RS256'); 

})
